# DeltaFStation 系统架构

## 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                    DeltaFStation 量化交易系统                      │
├─────────────────────────────────────────────────────────────┤
│  前端层 (Frontend)                                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   主页      │  │  策略分析   │  │  仿真交易   │         │
│  │  (index)    │  │ (strategy)  │  │  (trading)  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │              Bootstrap 5 + JavaScript                  │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  API层 (Backend API)                                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │  数据API    │  │  策略API    │  │  回测API    │         │
│  │(data_api)   │  │(strategy_api)│  │(backtest_api)│       │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│  ┌─────────────┐                                          │
│  │  仿真API    │                                          │
│  │(simulation_api)│                                       │
│  └─────────────┘                                          │
├─────────────────────────────────────────────────────────────┤
│  核心层 (Core Engine)                                      │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │  数据管理   │  │  回测引擎   │  │  仿真引擎   │         │
│  │(data_manager)│  │(backtest_engine)│(simulation_engine)│ │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
├─────────────────────────────────────────────────────────────┤
│  数据层 (Data Storage)                                     │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │  原始数据   │  │  策略配置   │  │  回测结果   │         │
│  │  (CSV)      │  │   (JSON)    │  │   (JSON)    │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│  ┌─────────────┐                                          │
│  │  仿真记录   │                                          │
│  │   (JSON)    │                                          │
│  └─────────────┘                                          │
└─────────────────────────────────────────────────────────────┘
```

## 核心模块说明

### 1. 数据管理模块 (Data Manager)
- **功能**: 数据导入、预处理、技术指标计算
- **支持格式**: CSV文件
- **数据源**: 文件上传、Yahoo Finance API
- **技术指标**: MA、RSI、MACD、布林带等

### 2. 策略管理模块 (Strategy Manager)
- **策略类型**: 技术分析、基本面分析、机器学习
- **策略配置**: JSON格式存储
- **参数管理**: 动态参数调整
- **规则引擎**: 交易规则定义

### 3. 回测引擎 (Backtest Engine)
- **历史回测**: 基于历史数据的策略验证
- **成本考虑**: 手续费、滑点计算
- **风险指标**: 夏普比率、最大回撤、胜率等
- **结果可视化**: 图表展示回测结果

### 4. 仿真引擎 (Simulation Engine)
- **实时仿真**: 基于实时数据的策略执行
- **手动交易**: 支持手动下单
- **持仓管理**: 实时持仓跟踪
- **风险控制**: 资金管理和风险控制

## 数据流

```
数据输入 → 数据预处理 → 策略分析 → 信号生成 → 交易执行 → 结果分析
    ↓           ↓           ↓           ↓           ↓           ↓
  CSV文件    技术指标    策略规则    买卖信号    仿真交易    回测报告
```

## 技术特点

### 后端特点
- **轻量级**: 基于Flask的轻量级Web框架
- **模块化**: 清晰的模块分离和职责划分
- **可扩展**: 易于添加新的策略类型和指标
- **数据驱动**: 基于CSV的简单数据存储

### 前端特点
- **响应式**: 基于Bootstrap 5的响应式设计
- **交互性**: 丰富的JavaScript交互功能
- **可视化**: Chart.js图表展示
- **用户友好**: 简洁直观的用户界面

### 系统特点
- **简洁明了**: 专注于核心功能，避免过度复杂
- **个人使用**: 面向个人投资者的量化交易需求
- **快速部署**: 一键启动，无需复杂配置
- **学习友好**: 代码结构清晰，便于学习和修改

## 部署架构

```
开发环境:
├── Python 3.8+
├── 虚拟环境 (推荐)
├── 依赖包 (requirements.txt)
└── 启动脚本 (run.py)

生产环境:
├── 服务器部署
├── 反向代理 (Nginx)
├── 进程管理 (PM2/Supervisor)
└── 监控日志
```

## 扩展性

### 水平扩展
- 支持多用户部署
- 数据库升级 (SQLite → PostgreSQL)
- 缓存层添加 (Redis)

### 功能扩展
- 更多技术指标
- 机器学习模型
- 实盘交易接口
- 风险管理系统

## 安全考虑

- **数据安全**: 本地数据存储，避免敏感信息泄露
- **输入验证**: 严格的数据验证和清理
- **错误处理**: 完善的异常处理机制
- **日志记录**: 详细的操作日志记录
